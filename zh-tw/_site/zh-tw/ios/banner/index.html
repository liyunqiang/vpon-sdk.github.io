<h2 id="section">完成串接指示</h2>
<hr />
<p>若您尚未完成串接廣告形式前的串接說明，請先前往<a href="../integration-guide/">串接說明</a>完成相關設定</p>

<h1 id="section-1">概要</h1>
<hr />
<p>Vpon 橫幅廣告 (banner) 利用畫面的一小部分來吸引使用者點擊，即可打開全螢幕享受更豐富的瀏覽體驗，例如網站或應用程式商店網頁。</p>

<h1 id="banner">開始撰寫 Banner</h1>
<hr />
<p>iOS 應用程式由 UIView 物件所組成，也就是以文字區域和按鈕等控制項的形式向使用者顯示的 Objective-C 執行個體。VpadnBanner 只是一種 UIView 子類別，用來顯示由使用者點擊觸發的小型 HTML5 廣告。</p>

<p>和所有的 UIView 一樣，用程式碼編寫 VpadnBanner 很簡單。以下為所需步驟:</p>

<ol>
  <li>匯入 <code class="highlighter-rouge">VpadnBanner.h</code> 與 <code class="highlighter-rouge">VpadnInterstitial.h</code></li>
  <li>在應用程式的 UIViewController 中宣告 <code class="highlighter-rouge">VpadnBanner</code></li>
  <li>建立 VpadnBanner 物件</li>
  <li>指定 BannerId，也就是 Vpadn 申請的 BannerId</li>
  <li>設定 window 的rootViewController</li>
  <li>將該 View 加進 ViewController 內</li>
  <li>拉取廣告</li>
</ol>

<p>建議您最好在應用程式的 UIViewController 內執行上述所有步驟。</p>

<p>```Objective-C
#import &lt;UIKit/UIKit.h&gt;
// 載入標頭檔
#import “VpadnBanner.h”
#import “VpadnInterstitial.h”</p>

<p>// 增加兩個protocol接收廣告狀態
@interface ViewController : UIViewController&lt;VpadnBannerDelegate, VpadnInterstitialDelegate&gt;
{
    VpadnBanner*    vpadnAd; // 宣告使用VpadnBanner廣告
    VpadnInterstitial*    vpadnInterstitial; // 宣告使用Vpadn插屏廣告
}
@end
```</p>

<h2 id="section-2">初始化設定</h2>

<p>以下程式碼會在 viewController的 viewDidLoad 初始化步驟中設定橫幅廣告。</p>

<p>```Objective-C
@implementation ViewController</p>

<ul>
  <li>
    <p>(void)dealloc
{
  if(nil != vpadnAd)
  {
      [vpadnAd release];
      vpadnAd = nil;
  }
  if(nil != vpadnInterstitial)
  {
      [vpadnInterstitial release];
      vpadnInterstitial = nil;
  }
  [super dealloc];
}</p>
  </li>
  <li>
    <p>(void)viewDidLoad
{
[super viewDidLoad];
  // Do any additional setup after loading the view, typically from a nib.
BOOL bStatusBarHide = [UIApplication sharedApplication].statusBarHidden;
float screenHeight = [[UIScreen mainScreen] bounds].size.height;
if(!bStatusBarHide)
    screenHeight -= 20;
// 設定廣告位置
CGPoint origin = CGPointMake(0.0,screenHeight - CGSizeFromVpadnAdSize(VpadnAdSizeSmartBannerPortrait).height);
vpadnAd = [[VpadnBanner alloc] initWithAdSize:VpadnAdSizeSmartBannerPortrait origin:origin];  // 初始化Banner物件
vpadnAd.strBannerId = @””;   // 填入您的BannerId
vpadnAd.delegate = self;       // 設定delegate接收protocol回傳訊息
vpadnAd.platform = @”TW”;       // 台灣地區請填TW 大陸則填CN
[vpadnAd setAdAutoRefresh:YES]; //如果為mediation則set NO
[vpadnAd setRootViewController:self]; //請將window的rootViewController設定在此 以便廣告順利執行
[self.view addSubview:[vpadnAd getVpadnAdView]]; // 將VpadnBanner的View加入此ViewController中
[vpadnAd startGetAd:[self getTestIdentifiers]]; // 開始抓取Banner廣告</p>
  </li>
</ul>

<p>}
```</p>

<p>```Objective-C
#pragma mark VpadnAdDelegate method 接一般Banner廣告就需要新增
- (void)onVpadnAdReceived:(UIView *)bannerView{
    NSLog(@”廣告抓取成功”);
}</p>

<ul>
  <li>
    <p>(void)onVpadnAdFailed:(UIView *)bannerView didFailToReceiveAdWithError:(NSError *)error{
  NSLog(@”廣告抓取失敗”);
}</p>
  </li>
  <li>
    <p>(void)onVpadnPresent:(UIView *)bannerView{
  NSLog(@”開啟vpadn廣告頁面 %@”,bannerView);
}</p>
  </li>
  <li>
    <p>(void)onVpadnDismiss:(UIView *)bannerView{
  NSLog(@”關閉vpadn廣告頁面 %@”,bannerView);
}</p>
  </li>
  <li>
    <p>(void)onVpadnLeaveApplication:(UIView *)bannerView{
  NSLog(@”離開publisher application”);
}</p>
  </li>
</ul>

<h1 id="pragma-mark-vpadninterstitial-delegate-interstitial">pragma mark VpadnInterstitial Delegate 有接Interstitial的廣告才需要新增</h1>
<ul>
  <li>
    <p>(void)onVpadnInterstitialAdReceived:(UIView *)bannerView{
  NSLog(@”插屏廣告抓取成功”);
  // 顯示插屏廣告
  [vpadnInterstitial show];
}</p>
  </li>
  <li>
    <p>(void)onVpadnInterstitialAdFailed:(UIView *)bannerView{
  NSLog(@”插屏廣告抓取失敗”);
}</p>
  </li>
  <li>
    <p>(void)onVpadnInterstitialAdDismiss:(UIView *)bannerView{
  NSLog(@”關閉插屏廣告頁面 %@”,bannerView);
}</p>
  </li>
</ul>

<h1 id="pragma-mark-vpadn">pragma mark 通知關閉vpadn開屏廣告</h1>
<ul>
  <li>(void)onVpadnSplashAdDismiss{
  NSLog(@”關閉vpadn開屏廣告頁面”);
}</li>
</ul>

<p>@end
```</p>

<h2 id="section-3">測試廣告</h2>

<p><code class="highlighter-rouge">objective-c
// 請新增此function到您的程式內 如果為測試用 則在下方填入UUID，即可看到測試廣告。
-(NSArray*)getTestIdentifiers
{
  return [NSArray arrayWithObjects:
    // add your test UUID
    @"your_UUID",
    nil];
}
</code></p>

<h1 id="section-4">橫幅廣告大小</h1>
<hr />
<p>除了支援手機上的 320x50 大小外，還支援各種不同的橫幅廣告：</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">大小 (寬度x高度)</th>
      <th style="text-align: center">說明</th>
      <th style="text-align: center">VponAdSize 常數值</th>
      <th style="text-align: center">適用裝置</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">320x50</td>
      <td style="text-align: center">標準橫幅廣告</td>
      <td style="text-align: center">VpadnAdSizeBANNER</td>
      <td style="text-align: center">iPhone &amp; iPad</td>
    </tr>
    <tr>
      <td style="text-align: center">468x60</td>
      <td style="text-align: center">IAB 全橫幅廣告</td>
      <td style="text-align: center">VpadnAdSizeFullBanner</td>
      <td style="text-align: center">iPad</td>
    </tr>
    <tr>
      <td style="text-align: center">728x90</td>
      <td style="text-align: center">IAB 超級橫幅廣告</td>
      <td style="text-align: center">VpadnAdSizeLeaderboard</td>
      <td style="text-align: center">iPad</td>
    </tr>
    <tr>
      <td style="text-align: center">300x250</td>
      <td style="text-align: center">IAB 中矩形廣告</td>
      <td style="text-align: center">VpadnAdSizeMediumRectangle</td>
      <td style="text-align: center">iPad</td>
    </tr>
    <tr>
      <td style="text-align: center">device width x auto height</td>
      <td style="text-align: center">Smart Banner Portrait</td>
      <td style="text-align: center">VpadnAdSizeSmartBannerPortrait</td>
      <td style="text-align: center">iPhone &amp; iPad</td>
    </tr>
    <tr>
      <td style="text-align: center">device width x auto height</td>
      <td style="text-align: center">Smart Banner Landscape</td>
      <td style="text-align: center">VpadnAdSizeSmartBannerLandscape</td>
      <td style="text-align: center">iPhone &amp; iPad</td>
    </tr>
  </tbody>
</table>

<p>如無特定需求，我們建議您直接使用上面 <code class="highlighter-rouge">smart banner</code>(portrait or landscape)即可</p>

<h1 id="section-5">更新廣告</h1>
<hr />
<p>如果您在伺服器的 Vpon 帳戶中指定了更新速率，且需要使用下面的 sample 才會啟動 banner 自動更新</p>

<p>[vpadnAd setAdAutoRefresh:YES];</p>

<h1 id="sample-code">下載 Sample code</h1>
<hr />
<p><a href="../download/">Go to download page</a></p>

<h1 id="section-6">結果</h1>
<hr />
<p>現在只要執行這個應用程式，您應該就會在畫面上看到橫幅廣告：
<img src="/IOS-Banner_result.png" alt="" class="width-300" /></p>

<h1 id="app-transport-security">App Transport Security</h1>
<hr />
<p>iOS9 多了安全條款 App Transport Security (ATS)，若您使用 Xcode 7 建立 iOS9 專案，請參考<a href="/zh-tw/ios/latest-news/ios9ats/">這篇</a>來修改部份設定</p>

<h1 id="section-7">其他訣竅</h1>
<blockquote>
  <p>請參閱<a href="../Interstitial">插頁廣告</a>、<a href="../mediation">中介服務</a>、<a href="../advanced">進階設定</a>中獲取更多簡介。</p>
</blockquote>

